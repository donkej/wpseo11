jQuery(function(a){a("#link-options").length&&(a(".wp-link-text-field","#link-options").before('<div><label><span>Title</span><input id="wp-link-title" type="text"></label></div>'),a(".link-target","#link-options").before('<div class="link-nofollow" style="float: right;margin: 3px 12% 0 0;"><label for="wp-link-nofollow"><input type="checkbox" id="wp-link-nofollow">Nofollow</label></div>'),a("#most-recent-results, #search-results","#wp-link").css("top",240),wpLink.mceRefresh=function(){var b=tinymce.get(wpActiveEditor);
var d=b.selection.getNode();var c=b.dom.getParent(d,"a[href]");if(c){var e=this.hasSelectedText(c);d=c.innerText||c.textContent;a("#wp-link-url").val(b.dom.getAttrib(c,"href"));a("#wp-link-title").val(b.dom.getAttrib(c,"title"));a("#wp-link-target").prop("checked","_blank"===b.dom.getAttrib(c,"target"));a("#wp-link-nofollow").prop("checked","nofollow"==b.dom.getAttrib(c,"rel"));a("#wp-link-submit").val(wpLinkL10n.update)}else d=b.selection.getContent({format:"text"}),this.setDefaultValues();e?(a("#wp-link-text").val(d||
""),a("#wp-link-wrap").addClass("has-text-field")):(a("#wp-link-text").val(""),a("#wp-link-wrap").removeClass("has-text-field"))},wpLink.getAttrs=function(){return{href:a.trim(a("#wp-link-url").val()),title:a.trim(a("#wp-link-title").val()),target:a("#wp-link-target").prop("checked")?"_blank":"",rel:a("#wp-link-nofollow").prop("checked")?"nofollow":""}},wpLink.updateFields=function(b,d){a("#wp-link-url").val(d.children(".item-permalink").val());a("#wp-link-title").val(d.children(".item-title").length?
d.children(".item-title").text():"")},wpLink.htmlUpdate=function(){var b=wpLink.textarea;if(b){var a=wpLink.getAttrs();if(a.href){var c='<a href="'+a.href+'"';a.title&&(c+=' title="'+a.title.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")+'"');a.target&&(c+=' target="'+a.target+'"');a.rel&&(c+=' rel="'+a.rel+'"');c+=">";if(document.selection&&wpLink.range)b.focus(),wpLink.range.text=c+wpLink.range.text+"</a>",wpLink.range.moveToBookmark(wpLink.range.getBookmark()),wpLink.range.select(),
wpLink.range=null;else if("undefined"!==typeof b.selectionStart){a=b.selectionStart;var e=b.selectionEnd;var f=b.value.substring(a,e);c=c+f+"</a>";var g=a+c.length;a!==e||f||(g-=4);b.value=b.value.substring(0,a)+c+b.value.substring(e,b.value.length);b.selectionStart=b.selectionEnd=g}wpLink.close();b.focus()}}},wpLink.setDefaultValues=function(){var b,d=tinymce.get(wpActiveEditor),c=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,e=/^(https?|ftp):\/\/[A-Z0-9.-]+\.[A-Z]{2,4}[^ "]*$/i;this.isMCE()?b=d.selection.getContent():
document.selection&&wpLink.range?b=wpLink.range.text:"undefined"!==typeof this.textarea.selectionStart&&(b=this.textarea.value.substring(this.textarea.selectionStart,this.textarea.selectionEnd));b&&c.test(b)?a("#wp-link-url").val("mailto:"+b):b&&e.test(b)?a("#wp-link-url").val(b.replace(/&amp;|&#0?38;/gi,"&")):a("#wp-link-url").val("");a("#wp-link-title").val("");a("#wp-link-submit").val(wpLinkL10n.save)})});
